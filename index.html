<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ñ–∏–¥–∫–æ–µ –°—Ç–µ–∫–ª–æ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(to bottom, #1a2a6c, #b21f1f, #fdbb2d); /* –ë–æ–ª–µ–µ —è—Ä–∫–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç */
            color: #fff;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }
        header {
            text-align: center;
            padding: 20px;
        }
        .score-board {
            font-size: 24px;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0,212,255,0.8);
        }
        .glass {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            padding: 20px;
            margin: 10px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .diamond-container {
            cursor: pointer;
            transition: transform 0.1s;
        }
        .diamond-container:active {
            transform: scale(0.9);
        }
        /* –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏–∫–æ–Ω–∫—É –∫—Ä–∏—Å—Ç–∞–ª–ª–∞, —Ç–∞–∫ –∫–∞–∫ —Å—Å—ã–ª–∫–∞ –Ω–∞ imgur –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–ø—Ä—è–º—É—é */
        .diamond {
            width: 150px;
            height: 150px;
            background: url('https://cdn-icons-png.flaticon.com/512/3209/3209943.png') no-repeat center center;
            background-size: contain;
            margin: 0 auto;
            filter: drop-shadow(0 0 15px rgba(255,255,255,0.5));
        }
        .button {
            display: inline-block;
            padding: 12px 25px;
            margin: 5px;
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: 0.3s;
        }
        .button:hover {
            background: rgba(255, 255, 255, 0.4);
        }
    </style>
</head>
<body>
    <header>
        <h1>–ñ–∏–¥–∫–æ–µ –°—Ç–µ–∫–ª–æ</h1>
        <div class="score-board">üíé –ö—Ä–∏—Å—Ç–∞–ª–ª—ã: <span id="count">0</span></div>
        <div class="diamond-container" id="click-zone">
            <div class="diamond"></div>
        </div>
    </header>

    <div class="glass">
        <h3>–£–ª—É—á—à–µ–Ω–∏—è</h3>
        <button class="button" onclick="alert('–°–∫–æ—Ä–æ!')">–ë—É—Å—Ç 1</button>
        <button class="button" onclick="alert('–°–∫–æ—Ä–æ!')">–ë—É—Å—Ç 2</button>
        <button class="button" onclick="alert('–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">–õ–∏–¥–µ—Ä–±–æ—Ä–¥</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let crystals = 0;
        // –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        const userId = tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id.toString() : 'guest';

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        async function loadStats() {
            try {
                const res = await fetch(`/get-stats?userId=${userId}`);
                const data = await res.json();
                crystals = data.crystals || 0;
                document.getElementById('count').innerText = crystals;
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö");
            }
        }

        // –ö–ª–∏–∫ –ø–æ –∫—Ä–∏—Å—Ç–∞–ª–ª—É
        document.getElementById('click-zone').onclick = () => {
            crystals++;
            document.getElementById('count').innerText = crystals;
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∂–¥—ã–µ 10 –∫–ª–∏–∫–æ–≤
            if (crystals % 10 === 0) saveStats();
        };

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        async function saveStats() {
            try {
                await fetch('/save-stats', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId, crystals })
                });
            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è");
            }
        }

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏
        window.addEventListener('beforeunload', saveStats);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadStats();
    </script>
</body>
</html>